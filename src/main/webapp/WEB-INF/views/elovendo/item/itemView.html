<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8"/>
<meta name="_csrf" th:content="${_csrf.token}"/>
<!-- default header name is X-CSRF-TOKEN -->
<meta name="_csrf_header" th:content="${_csrf.headerName}"/>

<!-- ************************* -->
<!-- ******* Bootstrap ******* -->
<!-- ************************* -->

<!-- Javascript -->
<script src="/js/jquery-1.11.0.min.js"></script>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="/css/bootstrap.min.css"/>
<!-- Latest compiled and minified JavaScript -->
<script src="/js/bootstrap.min.js"></script>
<!-- Styles -->
<link rel="stylesheet" type="text/css" href="/css/headerStyle.css" media="screen" />

<script src="/js/filter.js"></script>

<link rel="stylesheet" href="/css/styleweb.css" />
<link rel="stylesheet" href="/css/bootstrap-extra.css" />
 <!--  For share buttons -->
<link rel="stylesheet" href="/css/sharingStyle.css" />
<link rel="stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css"/>

<!-- Tabs x -->
<link href="/css/bootstrap-tabs-x.css" media="all" rel="stylesheet" type="text/css" />
<script src="/js/bootstrap-tabs-x.js" type="text/javascript"></script>

<!-- Lightbox -->
<!-- <link href="/css/bootstrap-lightbox.css" media="all" rel="stylesheet" type="text/css" /> -->
<!-- <script src="/js/bootstrap-lightbox.js" type="text/javascript"></script> -->
<script src="/js/lightbox.js"></script>
<link href="/css/lightbox.css" rel="stylesheet" />

<title>Item</title>
</head>
<body style="background-color:#FBFAF9;">
	
	<!-- Header -->
	<div th:replace="elovendo/header"></div>

	<div class="container">	
		<div class='tabs-x tabs-above board'>
<!-- 			<div class="board"> -->
<!-- <div class="board-inner"> -->
	    	<ul id="myTab-1" class="nav nav-tabs" role="tablist">
<!-- 	        	<li class="active"><a href="#itemContent" role="tab" data-toggle="tab"> -->
<!-- 	        	<i class="glyphicon glyphicon-tag"></i> Anuncio</a></li> -->
<!-- 				<li><a href="#geolocationContent" role="tab-kv" data-toggle="tab"> -->
<!-- 	        	<i class="glyphicon glyphicon-map-marker"></i> Localización</a></li> -->
<!-- 	        	<li><a href="#userContent" role="tab-kv" data-toggle="tab"> -->
<!-- 	        	<i class="glyphicon glyphicon-user"></i> Vendedor</a></li> -->
<!-- 	        	<li><a href="#videoContent" role="tab-kv" data-toggle="tab"> -->
<!-- 	        	<i class="glyphicon glyphicon-play-circle"></i> Vídeo</a></li> -->
	        	<li class="active">
					<a href="#itemContent" role="tab" data-toggle="tab" title="Anuncio">
						<span class="round-tabs green"> 
							<i class="glyphicon glyphicon-tag"></i>
						</span>
					</a>
	        	</li>
	        	<li>
	        		<a href="#geolocationContent" role="tab-kv" data-toggle="tab" title="Localización">
						<span class="round-tabs yellow"> 
							<i class="glyphicon glyphicon-map-marker"></i>
						</span>
					</a>
	        	</li>
	        	<li>
	        		<a href="#userContent" role="tab-kv" data-toggle="tab" title="Vendedor">
						<span class="round-tabs blue"> 
							<i class="glyphicon glyphicon-user"></i>
						</span>
					</a>
	        	</li>
	        	<li>
	        		<a href="#videoContent" role="tab-kv" data-toggle="tab" title="Vídeo">
						<span class="round-tabs red"> 
							<i class="glyphicon glyphicon-play-circle"></i>
						</span>
					</a>
	        	</li>
	        </ul>
<!-- 	        </div> -->
        </div>
        <!-- Item -->
        <div id="tabContent" class="tab-content">
        	<div class="tab-pane fade in active" id="itemContent">
				<div class="row">
					<div class="col-xs-12 col-md-12 itemViewThumb" >
						<div class="thumbnail">
							<a th:href="@{'http://www.elovendo.com/' + ${item.mainImage}}" data-lightbox="itemImage">
								<img alt="Image" th:src="@{'http://www.elovendo.com/' + ${item.mainImage}}"/>
							</a>
							<hr class="colorgraph" />
							<div class="text-center">
								<h3 th:if="${item.new}" style="display: inline; ">
									<span class="label label-danger">
									<i class="glyphicon glyphicon-fire"></i> Nuevo</span>
								</h3>
								<h3 th:if="${item.user.whatssapUser}" style="display: inline;" title="Usuario de Whatssap">
									<span class="label label-success">
									<i class="glyphicon glyphicon-phone"></i> Whatssap</span>
								</h3>
								<h3 th:if="${item.user.userValue} &gt; 70" style="display: inline;" 
									title="Deberías poder confiar en este usuario">
									<span class="label label-rep">
									<i class="glyphicon glyphicon-thumbs-up"></i> Reputado
									</span>
								</h3>
							</div>
							<div class="caption">
								<div class="row">
									<div class="col-xs-12 col-md-12">
										<h1 th:text="${item.title}" style="text-indent: 20px;">Title</h1><hr/>
										<div class="fullTextDesc" 
										style="text-indent: 20px; min-height: 500px; width: 100%; word-wrap: break-word; margin-top: 30px;">
										<span th:utext="${item.description}">Description</span>
										</div>
									</div>
								</div>
								<div class="row">
									<div class="col-xs-12 text-center">
										<div class="btn-group">
											<button class="btn btn-primary btn-lg" role="button"
												data-toggle="modal" data-target="#myModal">
												<i class="glyphicon glyphicon-send"></i> Enviar mensaje
											</button>
											<button class="btn btn-danger btn-lg" role="button"
												data-toggle="modal" data-target="#myModal">
												<i class="glyphicon glyphicon-exclamation-sign"></i>
												Denunciar
											</button>
										</div>
									</div>
								</div>
								<hr class="colorgraph" />
								<div class="row">
									<div class="col-xs-12 col-md-12">
										<div class="text-center">
											<div class="btn-group">
												<button class="btn btn-default btn-lg disabled">Compartir:</button>
												<a class="btn btn-default btn-lg" target="_blank"
													title="Like On Facebook"
													href="http://www.facebook.com/plugins/like.php?href=http%3A%2F%2Felovendo.com/elovendo/index.html">
													<i class="fa fa-thumbs-o-up fa-lg fb"></i>
												</a> <a class="btn btn-default btn-lg google-plus-one"
													target="_blank" title="+1 On Google"
													href="https://apis.google.com/_/+1/fastbutton?usegapi=1&amp;size=large&amp;hl=en&amp;url=http%3A%2F%2Feveloendo.com/elovendo/index.html">
													<i class="fa fa-google-plus fa-2x google"></i> <span
													class="google">1</span>
												</a> <a class="btn btn-default btn-lg" target="_blank"
													title="On Facebook"
													href="http://www.facebook.com/sharer.php?u=http%3A%2F%2Felovendo.com/elovendo/index.html">
													<i class="fa fa-facebook fa-lg fb"></i>
												</a> <a class="btn btn-default btn-lg" target="_blank"
													title="On Twitter"
													href="http://twitter.com/share?url=http%3A%2F%2Felovendo.com/elovendo/index.html">
													<i class="fa fa-twitter fa-lg tw"></i>
												</a> <a class="btn btn-default btn-lg" target="_blank"
													title="On Google Plus"
													href="https://plusone.google.com/_/+1/confirm?hl=en&amp;url=http%3A%2F%2Felovendo.com/elovendo/index.html">
													<i class="fa fa-google-plus fa-lg google"></i>
												</a>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- geoloation -->
			<div class="tab-pane fade" id="geolocationContent">
				<div class="row">
					<div class="col-xs-12 col-md-12" >
						<img th:src="@{'http://maps.googleapis.com/maps/api/staticmap?center=' + ${item.latitude}
						+ ',' + ${item.longitude} + '&amp;zoom=16&amp;size=600x300&amp;scale=2'}"
						style="width: 100%; height: 100%"/>
					</div>
				</div>
			</div>
			<!-- video -->
			<div class="tab-pane fade" id="videoContent">
				<div class="row">
					<div class="col-xs-12 col-md-12" >
						<iframe id="ytplayer" type="text/html" width="100%" height="600"
							th:src="@{${item.youtubeVideo} + '?autoplay=0&amp;autohide=1&amp;origin=http://elovendo.com'}"
							frameborder="0"></iframe>
					</div>
				</div>
			</div>
			<!-- user -->
			<div class="tab-pane fade" id="userContent">
				<div class="row">
					<div class="col-md-offset-2 col-md-8 col-lg-offset-2 col-lg-8">
						<div class="well profileStyle itemUserProfile">
							<div class="col-sm-12">
								<div class="col-xs-12 col-sm-8">
									<h2 th:text="${item.user.login}">user</h2>
									<hr class="hrStyle" />
									<p>
										<strong>Usuario desde: </strong> <span
											th:text="${#calendars.format(item.startDate, 'dd MMMM yyyy')}">ever</span>
									</p>
									<p>
										<strong>Bio: </strong> Read, out with friends, listen
										to music, draw and learn new things.
									</p>
									<div class="reputation">
										<h2>Reputación</h2>
										<hr class="hrStyle" />
										<div class="progress">
											<div th:if="${item.user.userValue} &gt; 69"
												class="progress-bar progress-bar-success" role="progressbar"
												th:attr="aria-valuenow=${item.user.userValue}"
												aria-valuemin="0" aria-valuemax="100"
												th:style="'width:' + ${item.user.userValue} + '%;'">
												<span class="sr-only"
													th:value="${item.user.userValue} + ' points. Excellent user.'"></span>
											</div>
											<div th:if="${item.user.userValue} &gt; 39"
												class="progress-bar progress-bar-warning" role="progressbar"
												th:attr="aria-valuenow=${item.user.userValue}"
												aria-valuemin="0" aria-valuemax="100"
												th:style="'width:' + ${item.user.userValue} + '%;'">
												<span class="sr-only"
													th:value="${item.user.userValue} + ' points. Average user.'"></span>
											</div>
											<div th:if="${item.user.userValue} &gt; 0"
												class="progress-bar progress-bar-danger" role="progressbar"
												th:attr="aria-valuenow=${item.user.userValue}"
												aria-valuemin="0" aria-valuemax="100"
												th:style="'width:' + ${item.user.userValue} + '%;'">
												<span class="sr-only"
													th:value="${item.user.userValue} + ' points. Bad user.'"></span>
											</div>
										</div>
									</div>
								</div>
								<div class="col-xs-12 col-sm-4 text-center">
									<figure>
										<img
											th:src="@{'http://www.elovendo.com/' + ${item.user.avatar}}"
											alt="" class="profilePic">
									</figure>
								</div>
							</div>
							<div class="col-xs-12 divider text-center">
								<div class="col-xs-12 col-sm-4 emphasis">
									<h2>
										<strong th:text="${votesPositive}">0</strong>
									</h2>
									<p>
										<small>Votos positivos</small>
									</p>
									<a href="#voteModal" data-toggle="modal" data-target="#voteModal" class="btn btn-success btn-block">
										<span class="fa fa-plus-circle"></span> Votar
									</a>
								</div>
								<div class="col-xs-12 col-sm-4 emphasis">
									<h2>
										<strong th:text="${votesNegative}">0</strong>
									</h2>
									<p>
										<small>Votos negativos</small>
									</p>
									<a class="btn btn-wd-green btn-block" role="button" th:href="@{'/site/public/' + ${item.user.login}}">
										<span class="fa fa-user"></span> Ver perfil
									</a>
								</div>
								<div class="col-xs-12 col-sm-4 emphasis">
									<h2>
										<strong th:text="${totalItems}">0</strong>
									</h2>
									<p>
										<small>Anuncios publicados</small>
									</p>
									<div class="dropdown"
										style="width: 100% !important;">
										<button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
											<span class="fa fa-gear"></span> Opciones <span class="caret"></span>
										</button>
<!-- 											<button type="button" class="btn btn-primary dropdown-toggle" -->
<!-- 												data-toggle="dropdown"> -->
<!-- 												<span class="caret"></span> <span class="sr-only">Toggle -->
<!-- 													Dropdown</span> -->
<!-- 											</button> -->
										<ul class="dropdown-menu text-left" role="menu">
											<li><a href="#"><span
													class="fa fa-envelope pull-right"></span> Enviar email </a></li>
											<li class="divider"></li>
											<li><a href="#"><span
													class="fa fa-warning pull-right"></span>Denunciar usuario </a></li>
										</ul>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	
<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">Enviar mensaje</h4>
      </div>
      <div class="modal-body">
      	<form role="form">
		  <div class="form-group">
		    <label for="exampleInputEmail1">Tu nombre</label>
		    <input type="email" class="form-control" id="exampleInputEmail1" placeholder="Enter email"/>
		  </div>
		  <div class="form-group">
		    <label for="exampleInputPassword1">Mensaje</label>
		    	<textarea id="textarea" class="form-control textarea" rows="5" 
						required="required" placeholder="Tu mensaje..." maxlength="1000"></textarea>
		  </div>
		  <div class="checkbox">
		    <label>
		      <input type="checkbox"/> Acepto las condiciones de uso
		    </label>
		  </div>
		  <button type="submit" class="btn btn-default">Submit</button>
		</form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-primary">Enviar</button>
      </div>
    </div>
  </div>
</div>

<!-- Vote modal -->
<div class="modal fade" id="voteModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">Votar usuario</h4>
      </div>
      <div class="modal-body">
      	<form role="form">
		  <div class="form-group">
		    <label for="exampleInputEmail1">Escribe tu comentario...</label>
		    <input type="text" class="form-control" id="voteComment" placeholder="Tu comentario..."
		    maxlength="50"/>
		  </div>
		  <input type="hidden" value="" name="voteType" id="voteType">
		  <div class="text-center">
<!-- 			  <button type="submit" class="btn btn-success iVote"> -->
<!-- 			  	<h4 style="display: inline;"><i class="glyphicon glyphicon-ok"></i></h4><h3 style="display: inline;"> Votar positivo</h3> -->
<!-- 			  </button> -->
								<div class="btn-group btn-group-success">
									<button type="button"
										class="btn btn-success dropdown-toggle iVote"
										data-toggle="dropdown">
										<h4 style="display: inline;"><i class="glyphicon glyphicon-ok"></i></h4><h6 style="display: inline;"> Votar positivo</h6> <span class="caret"></span>
									</button>
									<ul class="dropdown-menu" role="menu">
										<li><a id="sVote" href="#">Votar</a></li>
									</ul>
								</div>
								<div class="btn-group btn-group-danger">
									<button type="button"
										class="btn btn-danger dropdown-toggle iVote"
										data-toggle="dropdown">
										Voto negativo <span class="caret"></span>
									</button>
									<ul class="dropdown-menu" role="menu">
										<li><a id="nVote" href="#">Votar</a></li>
									</ul>
								</div>
								<!-- 			  <button type="submit" class="btn btn-danger iVote"> -->
<!-- 			  	<h4 style="display: inline;"><i class="glyphicon glyphicon-remove"></i></h4><h3 style="display: inline;"> Votar negativo</h3> -->
<!-- 			  </button> -->
		  </div>
		</form>
      </div>
    </div>
  </div>
</div>

<script th:inline="javascript">
/*<![CDATA[*/
var ui = /*[[${item.user.userId}]]*/ '';
var ii = /*[[${item.itemId}]]*/ '';
var cv = $("meta[name='_csrf']").attr("content");
var cn = $("meta[name='_csrf_header']").attr("content");
/*]]>*/
$('#sVote').on('click', function() {
	var e = "/site/vote";
	$.ajax({
		  type: "POST",
		  beforeSend: function (request) { request.setRequestHeader(cn, cv); },
		  url: e,
		  data: {uv: ui, iv: ii, vt: 1, msg: $('#voteComment').val()},
		  success: function(data) { 
			  if (data) alert( "vote ok");
			  else alert("vote not processed");
		  },
		  error: function() { alert( "error on voting" ); }
		});
});

$('#nVote').on('click', function() {
	var e = "/site/vote";
	$.ajax({
		  type: "POST",
		  beforeSend: function (request) { request.setRequestHeader(cn, cv); },
		  url: e,
		  data: {uv: ui, iv: ii, vt: 0, msg: $('#voteComment').val()},
		  success: function(data) { 
			  if (data) alert( "vote ok");
			  else alert("vote not processed");
		  },
		  error: function() { alert( "error on voting" ); }
		});
});
</script>

<script type="text/javascript">
function adjustModalMaxHeightAndPosition(){
    $('.modal').each(function(){
        if($(this).hasClass('in') == false){
            $(this).show(); /* Need this to get modal dimensions */
        };
        var contentHeight = $(window).height() - 60;
        var headerHeight = $(this).find('.modal-header').outerHeight() || 2;
        var footerHeight = $(this).find('.modal-footer').outerHeight() || 2;

        $(this).find('.modal-content').css({
            'max-height': function () {
                return contentHeight;
            }
        });

        $(this).find('.modal-body').css({
            'max-height': function () {
                return (contentHeight - (headerHeight + footerHeight));
            }
        });

        $(this).find('.modal-dialog').addClass('modal-dialog-center').css({
            'margin-top': function () {
            	console.log("height " + $(this).outerHeight());
            	console.log("height/2 " + $(this).outerHeight() /1000);
                return ($(this).outerHeight() / 2);
            },
            'margin-left': function () {
                return -($(this).outerWidth() / 2);
            }
        });
        if($(this).hasClass('in') == false){
            $(this).hide(); /* Hide modal */
        };
    });
};
if ($(window).height() >= 320){
    $(window).resize(adjustModalMaxHeightAndPosition).trigger("resize");
}


	$(function() {
		$('a[title]').tooltip();
		$('h3[title]').tooltip();
	});
</script>

</body>
</html>